!function(t){function n(e){if(a[e])return a[e].exports;var s=a[e]={exports:{},id:e,loaded:!1};return t[e].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}var a={};return n.m=t,n.c=a,n.p="",n(0)}([function(t,n,a){"use strict";angular.module("app",["ui.router","ngResource","ngAnimate","ngDialog","ngFileUpload","cgNotify"]).config(a(1)).filter("nameFilter",a(10)).filter("toolFilter",a(11))},function(t,n,a){"use strict";t.exports=["$stateProvider","$urlRouterProvider",function(t,n){n.otherwise(""),t.state("index",{url:"",views:{main:{template:a(2),controller:a(3)}}}).state("index.player",{url:"/player",views:{tab:{template:a(4),controller:a(5)}}}).state("index.setting",{url:"/setting",views:{tab:{template:a(6),controller:a(7)}}}).state("index.saw",{url:"/saw",views:{tab:{template:a(8),controller:a(9)}}})}]},function(t,n){t.exports='<div class="content-title">\r\n  <ul class="nav nav-pills">\r\n    <li ng-class="sref==\'index.player\'? \'active\' : \'default\'" ng-click="change($event)">\r\n      <a ui-sref="index.player">选手看板设置</a>\r\n    </li>\r\n    <li ng-class="sref==\'index.setting\'? \'active\' : \'default\'" ng-click="change($event)">\r\n      <a ui-sref="index.setting">活动设置</a>\r\n    </li>\r\n    <li ng-class="sref==\'index.saw\'? \'active\' : \'default\'" ng-click="change($event)">\r\n      <a ui-sref="index.saw">可见设置</a>\r\n    </li>\r\n  </ul>\r\n</div>\r\n<div class="content-ad">\r\n  <div class="row">\r\n    <div class="col-sm-3"></div>\r\n    <div class="col-sm-6">\r\n      <div class="input-group">\r\n        <input type="text" class="form-control ad-input" placeholder="公告输入" ng-model="notice">\r\n        <span class="input-group-btn">\r\n          <button class="btn btn-oppo" type="button" ng-click="sendNotice()">发送公告</button>\r\n        </span>\r\n      </div>\r\n    </div>\r\n    <div class="col-sm-3">\r\n      <div class="input-group">\r\n        <span class="input-group-btn">\r\n          <button class="btn btn-oppo" type="button" ng-click="seeNotice()">查看公告</button>\r\n        </span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div class="tab-content">\r\n  <div ui-view="tab"></div>\r\n</div>\r\n<script type="text/ng-template" id="notice_dialog">\r\n  <div class="alert" ng-class="{\'alert-success\': $odd, \'alert-info\': $even}" ng-repeat="data in noticeList">\r\n    {{data.create_time}} : {{data.content}}\r\n  </div>\r\n</script>'},function(t,n){"use strict";t.exports=["$scope","$state","notify","$resource","ngDialog",function(t,n,a,e,s){"index"===n.current.name?(n.go("index.player"),t.sref="index.player"):t.sref=n.current.name,t.change=function(n){t.sref=n.target.getAttribute("ui-sref")},t.sendNotice=function(){return t.notice?void 0:(a({message:"请填写公告",duration:1e4,classes:"alert-danger"}),!1)},t.seeNotice=function(){e("/walker/setting/notification/ ").query(function(n){t.noticeList=n,t.showNotice()},function(t){a({message:"获取公告失败",duration:1e4,classes:"alert-danger"})})},t.showNotice=function(){s.open({template:"notice_dialog",scope:t,className:"ngdialog-theme-default notice-dialog",showClose:!1,closeByDocument:!0})}}]},function(t,n){t.exports='<div class="row">\r\n  <button class="btn btn-primary ml20" ng-click="getPlayers()">刷新（每30s刷新一次）</button>\r\n</div>\r\n<div class="row">\r\n  <div class="content-content content-content-list1" ng-repeat="data in list1">\r\n    <div class="row content-content-1">\r\n      <div class="col-sm-8">\r\n        <div class="img img-list1">\r\n          <img ng-src="{{data.player.avatar}}" alt="" class="avatar">\r\n          <div class="name" title="{{data.player.name}}">{{data.player.name | nameFilter}}</div>\r\n          <div class="count">{{data.player.audience}}人</div>\r\n        </div>\r\n      </div>\r\n      <div class="col-sm-4">\r\n        <div class="remark remark-list1">{{data.player.role}}</div>\r\n        <div class="remark remark-list1">{{data.player.status}}</div>\r\n      </div>\r\n    </div>\r\n    <div class="content-content-2">\r\n      <div class="row color1">\r\n        <div class="col-sm-3">人气值</div>\r\n        <div class="col-sm-3">排名</div>\r\n        <div class="col-sm-3">土豆值</div>\r\n        <div class="col-sm-3">排名</div>\r\n      </div>\r\n      <div class="row color2 rank-list1">\r\n        <div class="col-sm-3">{{data.player.money}}</div>\r\n        <div class="col-sm-3">{{data.player.monry_rank}}</div>\r\n        <div class="col-sm-3">{{data.player.tudou}}</div>\r\n        <div class="col-sm-3">{{data.player.todou_rank}}</div>\r\n      </div>\r\n    </div>\r\n    <div class="content-content-3">\r\n      <div class="row edit-info" ng-click="editInfo(data)">\r\n        修改信息\r\n      </div>\r\n    </div>\r\n    <div class="content-content-4">\r\n      <div class="row content-content-4-list" ng-repeat="data in data.items | toolFilter">\r\n        <div class="col-sm-4">\r\n          <img class="tools" ng-src="{{data.picUrl}}" alt="" title="{{data.title}}">\r\n        </div>\r\n        <div class="col-sm-4">\r\n          {{data.usedAmount}}\r\n        </div>\r\n        <div class="col-sm-4">\r\n          {{data.mixAmount}}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div class="row">\r\n  <div class="content-content" ng-repeat="data in list2">\r\n    <div class="row content-content-1">\r\n      <div class="col-sm-8">\r\n        <div class="img">\r\n          <img ng-src="{{data.player.avatar}}" alt="" class="avatar">\r\n          <div class="name" title="{{data.player.name}}">{{data.player.name | nameFilter}}</div>\r\n          <div class="count">{{data.player.audience}}人</div>\r\n        </div>\r\n      </div>\r\n      <div class="col-sm-4">\r\n        <div class="remark">{{data.player.role}}</div>\r\n        <div class="remark">{{data.player.status}}</div>\r\n      </div>\r\n    </div>\r\n    <div class="content-content-2">\r\n      <div class="row color1">\r\n        <div class="col-sm-3">人气值</div>\r\n        <div class="col-sm-3">排名</div>\r\n        <div class="col-sm-3">土豆值</div>\r\n        <div class="col-sm-3">排名</div>\r\n      </div>\r\n      <div class="row color2">\r\n        <div class="col-sm-3">{{data.player.money}}</div>\r\n        <div class="col-sm-3">{{data.player.monry_rank}}</div>\r\n        <div class="col-sm-3">{{data.player.tudou}}</div>\r\n        <div class="col-sm-3">{{data.player.todou_rank}}</div>\r\n      </div>\r\n    </div>\r\n    <div class="content-content-3">\r\n      <div class="row edit-info" ng-click="editInfo(data)">\r\n        修改信息\r\n      </div>\r\n    </div>\r\n    <div class="content-content-4">\r\n      <div class="row content-content-4-list" ng-repeat="data in data.items | toolFilter">\r\n        <div class="col-sm-4">\r\n          <img class="tools" ng-src="{{data.picUrl}}" alt="" title="{{data.title}}">\r\n        </div>\r\n        <div class="col-sm-4">\r\n          {{data.usedAmount}}\r\n        </div>\r\n        <div class="col-sm-4">\r\n          {{data.mixAmount}}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div class="row">\r\n  <div class="content-content content-content-list3" ng-repeat="data in list3">\r\n    <div class="row content-content-1">\r\n      <div class="col-sm-8">\r\n        <div class="img img-list3">\r\n          <img ng-src="{{data.player.avatar}}" alt="" class="avatar">\r\n          <div class="name" title="{{data.player.name}}">{{data.player.name | nameFilter}}</div>\r\n          <div class="count">{{data.player.audience}}人</div>\r\n        </div>\r\n      </div>\r\n      <div class="col-sm-4">\r\n        <div class="remark remark-list3">{{data.player.role}}</div>\r\n        <div class="remark remark-list3">{{data.player.status}}</div>\r\n      </div>\r\n    </div>\r\n    <div class="content-content-2">\r\n      <div class="row">\r\n        <div class="col-sm-3">人气值</div>\r\n        <div class="col-sm-3">排名</div>\r\n        <div class="col-sm-3">土豆值</div>\r\n        <div class="col-sm-3">排名</div>\r\n      </div>\r\n      <div class="row color2 rank-list3">\r\n        <div class="col-sm-3">{{data.player.money}}</div>\r\n        <div class="col-sm-3">{{data.player.monry_rank}}</div>\r\n        <div class="col-sm-3">{{data.player.tudou}}</div>\r\n        <div class="col-sm-3">{{data.player.todou_rank}}</div>\r\n      </div>\r\n    </div>\r\n    <div class="content-content-3">\r\n      <div class="row edit-info" ng-click="editInfo(data)">\r\n        修改信息\r\n      </div>\r\n    </div>\r\n    <div class="content-content-4">\r\n      <div class="row content-content-4-list" ng-repeat="data in data.items | toolFilter">\r\n        <div class="col-sm-4">\r\n          <img class="tools" ng-src="{{data.picUrl}}" alt="" title="{{data.title}}">\r\n        </div>\r\n        <div class="col-sm-4">\r\n          {{data.usedAmount}}\r\n        </div>\r\n        <div class="col-sm-4">\r\n          {{data.mixAmount}}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<script type="text/ng-template" id="dialog">\r\n  <div class="row dialog-layer-1">\r\n    <div class="col-sm-2">\r\n      <div class="img">\r\n        <img ng-src="{{editData.player.avatar}}" alt="" class="avatar">\r\n        <div>{{editData.player.name | nameFilter}}</div>\r\n        <div>{{editData.player.audience}}人</div>\r\n      </div>\r\n    </div>\r\n    <div class="col-sm-2 remark">\r\n      {{editData.player.role}}\r\n    </div>\r\n    <div class="col-sm-6">\r\n      <div class="row color1">\r\n        <div class="col-sm-3">人气值</div>\r\n        <div class="col-sm-3">排名</div>\r\n        <div class="col-sm-3">pk值</div>\r\n        <div class="col-sm-3">排名</div>\r\n      </div>\r\n      <div class="row color2">\r\n        <div class="col-sm-3">{{editData.player.money}}</div>\r\n        <div class="col-sm-3">{{editData.player.monry_rank}}</div>\r\n        <div class="col-sm-3">{{editData.player.tudou}}</div>\r\n        <div class="col-sm-3">{{editData.player.todou_rank}}</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="row dialog-layer-2">\r\n    <div class="col-sm-6">\r\n      <div class="row">\r\n        <div class="col-sm-3">\r\n          角色\r\n        </div>\r\n        <div class="col-sm-4">\r\n          <select class="form-control select-check" ng-options="role.name as role.name for role in roleList" ng-model="editData.player.role">\r\n          </select>\r\n        </div>\r\n        <div class="col-sm-2">\r\n        </div>\r\n        <div class="col-sm-3 dialog-layer-2-line">\r\n          <button class="btn btn-dialog-2" ng-click="editRole()">确定</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class="col-sm-6">\r\n      <div class="row">\r\n        <div class="col-sm-3">\r\n          状态\r\n        </div>\r\n        <div class="col-sm-4">\r\n          <select class="form-control select-check" ng-options="status.name as status.name for status in statusList" ng-model="editData.player.status">\r\n          </select>\r\n        </div>\r\n        <div class="col-sm-2">\r\n        </div>\r\n        <div class="col-sm-3">\r\n          <button class="btn btn-dialog-2" ng-click="editStatus()">确定</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="row dialog-layer-3">\r\n    <div class="mt30">\r\n      <div class="wd50 fl" ng-repeat="data in editData.items">\r\n        <div class="col-sm-1">\r\n          <span ng-if="data.playerNeed !== 0">急</span>\r\n        </div>\r\n        <div class="col-sm-2">\r\n          <img src="" alt="" class="avatar" ng-src="{{data.picUrl}}" title="{{data.title}}">\r\n        </div>\r\n        <div class="col-sm-4">\r\n          <div class="progress mt16">\r\n            <div class="progress-bar progress-bar-danger progress-bar-striped" role="progressbar" aria-valuenow="80" aria-valuemin="0"\r\n              aria-valuemax="100" ng-class="{\'wd0\': (data.currentAmount/data.fundTotalAmount < 0.2), \'wd20\': (data.currentAmount/data.fundTotalAmount < 0.4 && data.currentAmount/data.fundTotalAmount >= 0.2)}">\r\n              <span class="sr-only">80% Complete (danger)</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class="col-sm-2 ml20 crp mt12" ng-click="showInput(data)" ng-hide="data.isClick">{{data.usedAmount}}/{{data.mixAmount}}</div>\r\n        <div class="col-sm-2 ml20 mt7">\r\n          <input type="text" class="form-control" ng-model="data.usedAmount" ng-show="data.isClick">\r\n        </div>\r\n        <div class="col-sm-1 mt7">\r\n          <button class="btn btn-default" ng-show="data.isClick" ng-click="editNum(editData, data)">确定</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</script>'},function(t,n){"use strict";t.exports=["$scope","$state","ngDialog","notify","$resource","$interval",function(t,n,a,e,s,r){t.getPlayers=function(){s("/walker/player/list").get(function(n){t.list1=n["追捕者"],t.list2=n["逃亡者"],t.list3=n["候补者"]},function(t){e({message:"获取数据失败,请刷新",duration:1e4,classes:"alert-danger"})})},t.getPlayers(),t.editInfo=function(n){t.editDataOrigin=n,t.editData=angular.copy(n),t.isShowDiv=!0,a.open({template:"dialog",scope:t,className:"ngdialog-theme-default",showClose:!0,closeByDocument:!1,trapFocus:!1})},t.roleList=[{name:"逃亡者"},{name:"追捕者"},{name:"候补者"}],t.statusList=[{name:"正常"},{name:"入狱"},{name:"淘汰"}],t.editRole=function(){s("/walker/player/:id").save({id:t.editData.player.playerid},{role:t.editData.player.role},function(n){e({message:"角色修改成功",duration:1e4,classes:"alert-success"}),t.getPlayers()},function(t){e({message:"角色修改失败",duration:1e4,classes:"alert-danger"})})},t.editStatus=function(){s("/walker/player/:id").save({id:t.editData.player.playerid},{status:t.editData.player.status}).$promise.then(function(n){e({message:"状态修改成功",duration:1e4,classes:"alert-success"}),t.editDataOrigin.player.status=t.editData.player.status},function(t){e({message:"状态修改失败",duration:1e4,classes:"alert-danger"})})},t.showInput=function(t){t.isClick=!0},t.editNum=function(n,a){s("/walker/player/:id/:itemId").save({id:n.player.playerid,itemId:a.itemId},{usedAmount:parseInt(a.usedAmount,10)}).$promise.then(function(n){e({message:"数目修改成功",duration:1e4,classes:"alert-success"}),a.isClick=!1,t.getPlayers()},function(t){e({message:"数目修改失败",duration:1e4,classes:"alert-danger"})})}}]},function(t,n){t.exports='<div class="set">\r\n  <div class="role-set">地图元素维护</div>\r\n  <div class="map-title-set">默认区域设置</div>\r\n  <table class="table map-table table-hover">\r\n    <thead>\r\n      <tr>\r\n        <th class="">区域中心</th>\r\n        <th class="">半径</th>\r\n        <th class="">美化系数（乘）</th>\r\n        <th class="">美化系数（加）</th>\r\n        <th class="">距离提醒（开关）</th>\r\n        <th class="">距离提醒（距离）</th>\r\n        <th class="">操作</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr>\r\n        <td>\r\n          <span>{{settings.center.lng}},{{settings.center.lat}}</span>\r\n          <span name="edit_map" class="glyphicon glyphicon-map-marker set-font-size" title="点击修改坐标" ng-click="show_map_dialog(settings)"></span>\r\n        </td>\r\n        <td>\r\n          <span>{{settings.radius}}</span>\r\n        </td>\r\n        <td>\r\n          <span>{{settings.add}}</span>\r\n        </td>\r\n        <td>\r\n          <span>{{settings.mul}}</span>\r\n        </td>\r\n        <td>\r\n          <span>{{settings.distanceWarning.switch}}</span>\r\n        </td>\r\n        <td>\r\n          <span>{{settings.distanceWarning.distance}}</span>\r\n        </td>\r\n        <td>\r\n          <a href="javascript:;" ng-click="edit_setting()">修改</a>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n  <div class="map-title-set">特殊建筑维护</div>\r\n  <table class="table map-table table-hover">\r\n    <thead>\r\n      <tr>\r\n        <th class="wd17">建筑图标</th>\r\n        <th class="wd11">名称</th>\r\n        <th class="wd11">角色</th>\r\n        <th class="wd11">电话号码</th>\r\n        <th class="wd32">坐标</th>\r\n        <th class="wd18">操作</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr ng-repeat="data in buildings">\r\n        <td><img src="" alt="" ng-src="{{data.imgUrl}}"></td>\r\n        <td>{{data.name}}</td>\r\n        <td>{{data.name}}</td>\r\n        <td>{{data.name}}</td>\r\n        <td>\r\n          <span>{{data.coordinate}}</span>\r\n          <span name="edit_map" class="glyphicon glyphicon-map-marker set-font-size" title="点击修改坐标" ng-click="show_map_dialog(data)"></span>\r\n        </td>\r\n        <td>\r\n          <a href="javascript:;" ng-click="edit_build(data)">修改</a>\r\n          <a class="btn-del" href="javascript:;" ng-click="del_build(data.id)">删除</a>\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td>\r\n          <img src="" alt="" ng-src="{{build.imgUrl}}">\r\n          <div class="upload" type="file" ngf-select="upload_build($file)" accept="image/*" ngf-max-height="100000" ngf-max-size="10MB">上传图标</div>\r\n        </td>\r\n        <td><input type="text" class="form-control" placeholder="请输入名称" ng-model="build.name"></td>\r\n        <td>\r\n          <select class="form-control" ng-options="role.name as role.name for role in roleList" ng-model="build.role"></select>\r\n        </td>\r\n        <td>\r\n          <input type="text" class="form-control" placeholder="请输入电话号码" ng-model="build.tel">\r\n        </td>\r\n        <td>\r\n          <span>{{build.coordinate}}</span>\r\n          <span class="glyphicon glyphicon-map-marker set-font-size" title="点击设置坐标" ng-click="show_map_dialog(data)"></span>\r\n        </td>\r\n        <td>\r\n          <button class="btn btn-oppo" ng-click="add_build()" ng-disabled="isAddBuild">添加特殊建筑</button>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n  <div class="map-title-set">选手维护</div>\r\n  <table class="table map-table table-hover">\r\n    <thead>\r\n      <tr>\r\n        <th>头像</th>\r\n        <th>姓名</th>\r\n        <th>性别</th>\r\n        <th>手机号</th>\r\n        <th>角色</th>\r\n        <th>操作</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr ng-repeat="data in players">\r\n        <td class="wd18">\r\n          <img ng-src="{{data.imgUrl}}" alt="">\r\n        </td>\r\n        <td class="wd16">{{data.name}}</td>\r\n        <td class="wd16">{{data.sex}}</td>\r\n        <td class="wd16">{{data.phone}}</td>\r\n        <td class="wd16">{{data.role}}</td>\r\n        <td class="wd18">\r\n          <a href="javascript:;" ng-click="edit_player(data)">修改</a>\r\n          <a class="btn-del" href="javascript:;" ng-click="del_player(data.id)">删除</a>\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td>\r\n          <img src="" alt="" ng-src="{{player.imgUrl}}">\r\n          <div class="upload" type="file" ngf-select="upload_player($file)" accept="image/*" ngf-max-height="100000" ngf-max-size="10MB">上传头像</div>\r\n        </td>\r\n        <td><input type="text" class="form-control" placeholder="请输入姓名" ng-model="player.name"></td>\r\n        <td>\r\n          <select class="form-control" ng-model="player.sex">\r\n            <option value="男">男</option>\r\n            <option value="女">女</option>\r\n          </select>\r\n        </td>\r\n        <td><input type="text" class="form-control" placeholder="请输入手机号" ng-model="player.phone"></td>\r\n        <td>\r\n          <select class="form-control" ng-model="player.role">\r\n            <option value="逃亡者">逃亡者</option>\r\n            <option value="追击者">追击者</option>\r\n          </select>\r\n        </td>\r\n        <td>\r\n          <button class="btn btn-oppo" ng-click="add_player()" ng-disabled="isAddPlayer">添加选手</button>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n<!--区域设置 修改框-->\r\n<script type="text/ng-template" id="edit_setting_dialog">\r\n  <div class="row mb10">\r\n    <label class="col-sm-4">半径</label>\r\n    <div class="col-sm-8">\r\n      <input type="text" class="form-control" placeholder="请输入半径" ng-model="settingEdit.radius">\r\n    </div>\r\n  </div>\r\n  <div class="row mb10">\r\n    <label class="col-sm-4">美化系数（乘）</label>\r\n    <div class="col-sm-8">\r\n      <input type="text" class="form-control" placeholder="请输入美化系数" ng-model="settingEdit.mul">\r\n    </div>\r\n  </div>\r\n  <div class="row mb10">\r\n    <label class="col-sm-4">美化系数（加）</label>\r\n    <div class="col-sm-8">\r\n      <input type="text" class="form-control" placeholder="请输入美化系数" ng-model="settingEdit.add">\r\n    </div>\r\n  </div>\r\n  <div class="row mb10">\r\n    <label class="col-sm-4">距离提醒（开关）</label>\r\n    <div class="col-sm-8">\r\n      <select class="form-control select-check" ng-model="settingEdit.switch">\r\n        <option value="on">开</option>\r\n        <option value="off">关</option>\r\n      </select>\r\n    </div>\r\n  </div>\r\n  <div class="row mb10">\r\n    <label class="col-sm-4">距离提醒（距离）</label>\r\n    <div class="col-sm-8">\r\n      <input type="text" class="form-control" placeholder="请输入距离" ng-model="settingEdit.distance">\r\n    </div>\r\n  </div>\r\n  <div class="row">\r\n    <button class="ngdialog-button ngdialog-button-primary" ng-click="closeThisDialog(0)">关闭</button>\r\n    <button class="ngdialog-button ngdialog-button-primary" ng-click="update_setting()">保存</button>\r\n  </div>\r\n</script>\r\n<!--特殊建筑维护 修改框-->\r\n<script type="text/ng-template" id="edit_build_dialog">\r\n  <div class="row edit_build_dialog mb10">\r\n    <label class="col-sm-3">建筑图标</label>\r\n    <div class="col-sm-9">\r\n      <img src="" alt="" ng-src="{{buildEdit.imgUrl}}">\r\n      <div class="upload dialog-upload" type="file" ngf-select="edit_upload_build($file)" accept="image/*" ngf-max-height="100000"\r\n        ngf-max-size="10MB">上传图标</div>\r\n    </div>\r\n  </div>\r\n  <div class="row mb10">\r\n    <label class="col-sm-3">名称</label>\r\n    <div class="col-sm-9">\r\n      <input type="text" class="form-control" placeholder="请输入名称" ng-model="buildEdit.name">\r\n    </div>\r\n  </div>\r\n  <div class="row">\r\n    <button class="ngdialog-button ngdialog-button-primary" ng-click="closeThisDialog(0)">关闭</button>\r\n    <button class="ngdialog-button ngdialog-button-primary" ng-click="update_build()">保存</button>\r\n  </div>\r\n</script>\r\n<!--选手维护 修改框-->\r\n<script type="text/ng-template" id="edit_player_dialog">\r\n  <div class="row edit_build_dialog mb10">\r\n    <label class="col-sm-3">选手头像</label>\r\n    <div class="col-sm-9">\r\n      <img src="" alt="" ng-src="{{playerEdit.imgUrl}}">\r\n      <div class="upload dialog-upload" type="file" ngf-select="edit_upload_player($file)" accept="image/*" ngf-max-height="100000"\r\n        ngf-max-size="10MB">上传头像</div>\r\n    </div>\r\n  </div>\r\n  <div class="row mb10">\r\n    <label class="col-sm-3">姓名</label>\r\n    <div class="col-sm-9">\r\n      <input type="text" class="form-control" placeholder="请输入姓名" ng-model="playerEdit.name">\r\n    </div>\r\n  </div>\r\n  <div class="row mb10">\r\n    <label class="col-sm-3">性别</label>\r\n    <div class="col-sm-9">\r\n      <select class="form-control" ng-model="playerEdit.sex">\r\n        <option value="男">男</option>\r\n        <option value="女">女</option>\r\n      </select>\r\n    </div>\r\n  </div>\r\n  <div class="row mb10">\r\n    <label class="col-sm-3">手机号</label>\r\n    <div class="col-sm-9">\r\n      <input type="text" class="form-control" placeholder="请输入手机号" ng-model="playerEdit.phone">\r\n    </div>\r\n  </div>\r\n  <div class="row mb10">\r\n    <label class="col-sm-3">角色</label>\r\n    <div class="col-sm-9">\r\n      <select class="form-control" ng-model="playerEdit.role">\r\n        <option value="逃亡者">逃亡者</option>\r\n        <option value="追击者">追击者</option>\r\n      </select>\r\n    </div>\r\n  </div>\r\n  <div class="row">\r\n    <button class="ngdialog-button ngdialog-button-primary" ng-click="closeThisDialog(0)">关闭</button>\r\n    <button class="ngdialog-button ngdialog-button-primary" ng-click="update_player()">保存</button>\r\n  </div>\r\n</script>\r\n<!--地图 -->\r\n<script type="text/ng-template" id="map_dialog">\r\n  <div class="row tac mb10">\r\n    <div class="map" id="mapContainer"></div>\r\n  </div>\r\n  <div class="row">\r\n    <button class="ngdialog-button ngdialog-button-primary" ng-click="set_map_position_colse()">关闭</button>\r\n    <button class="ngdialog-button ngdialog-button-primary" ng-click="set_map_position()">保存</button>\r\n  </div>\r\n</script>'},function(t,n){"use strict";t.exports=["$scope","$state","Upload","notify","$resource","ngDialog",function(t,n,a,e,s,r){t.clickPosition=null,t.show_map_dialog=function(n){n&&n.coordinate?(t.editBuildData=n,t.edit_build_mode=!0):n&&n.center&&(t.editSettingData=n,t.edit_setting_mode=!0),r.open({template:"map_dialog",scope:t,className:"ngdialog-theme-default",showClose:!1,closeByDocument:!1})},t.$on("ngDialog.opened",function(n,a){var e=new AMap.Map("mapContainer");if(e.r){if(e.setZoom(10),t.edit_build_mode){var s=t.editBuildData.coordinate.split(","),r=new AMap.LngLat(s[0],s[1]);e.setCenter([s[0],s[1]]),new AMap.Marker({position:r,map:e})}else if(t.edit_setting_mode){var r=new AMap.LngLat(t.editSettingData.center.lng,t.editSettingData.center.lat);e.setCenter([t.editSettingData.center.lng,t.editSettingData.center.lat]),new AMap.Marker({position:r,map:e})}else e.setCenter([120.619914,31.297599]);var i=function(n){e.clearMap(),new AMap.Marker({position:n.lnglat,map:e}),t.clickPosition=n.lnglat.lng+","+n.lnglat.lat};e.on("click",i)}}),t.set_map_position=function(){if(t.edit_build_mode)t.editBuildData.coordinate=t.clickPosition,t.edit_build_mode=!1;else if(t.edit_setting_mode){var n=t.clickPosition.split(",");s("/walker/setting/ ").save({},{centerLng:n[0]+"",centerLat:n[1]+""}).$promise.then(function(a){t.settings.center.lng=n[0],t.settings.center.lat=n[1],t.edit_setting_mode=!1,e({message:"修改成功",duration:1e4,classes:"alert-success"}),r.close()},function(t){e({message:"出错啦",duration:1e4,classes:"alert-danger"})})}else t.build.coordinate=t.clickPosition;r.close()},t.set_map_position_colse=function(){t.edit_setting_mode=!1,t.edit_build_mode=!1,r.close()},t.query_setting=function(){s("/walker/setting/ ").get().$promise.then(function(n){t.settings=n},function(t){e({message:"出错啦",duration:1e4,classes:"alert-danger"})})},t.query_setting(),t.edit_setting=function(){var n=t.settings;t.settingEdit={radius:n.radius,mul:n.mul,add:n.add,"switch":n.distanceWarning["switch"],distance:n.distanceWarning.distance},r.open({template:"edit_setting_dialog",scope:t,className:"ngdialog-theme-default edit_setting_dialog",showClose:!1,closeByDocument:!1})},t.update_setting=function(){var n=t.settingEdit;s("/walker/setting/ ").save({},{radius:parseInt(n.radius),add:parseInt(n.add),mul:parseInt(n.mul),warningSwitch:n["switch"],warningDistance:parseInt(n.distance)}).$promise.then(function(a){t.settings.radius=n.radius,t.settings.add=n.add,t.settings.mul=n.mul,t.settings.distanceWarning["switch"]=n["switch"],t.settings.distanceWarning.distance=n.distance,e({message:"修改成功",duration:1e4,classes:"alert-success"}),r.close()},function(t){e({message:"出错啦",duration:1e4,classes:"alert-danger"})})},t.roleList=[{name:" 基地"},{name:"监狱"},{name:"赌场"},{name:"安全屋"},{name:"角斗场"},{name:"移动商贩"},{name:"天眼"}],t.build={imgUrl:"",name:"",coordinate:""},t.isAddBuild=!1,t.query_build=function(){t.buildings=[{id:"1",imgUrl:"http://picset.tudou.com/2016-04-30/1461998878190-2089056432-diyup.jpg",name:"仓库",coordinate:"121.49393,31.192231"},{id:"2",imgUrl:"http://picset.tudou.com/2016-04-30/1461998878190-2089056432-diyup.jpg",name:"监狱",coordinate:"121.651858,31.044096"},{id:"3",imgUrl:"http://picset.tudou.com/2016-04-30/1461998878190-2089056432-diyup.jpg",name:"餐厅",coordinate:"120.621969,31.281598"}]},t.query_build(),t.upload_build=function(n){n&&a.upload({url:"/v1/img/upload",method:"POST",data:{image:n}}).then(function(n){var n=n.data;"success"===n.status?(t.build.imgUrl=n.url,e({message:"图标上传成功",duration:1e4,classes:"alert-success"})):e({message:"图标上传失败",duration:1e4,classes:"alert-danger"})},function(t){e({message:"图标上传失败",duration:1e4,classes:"alert-danger"})},function(t){})},t.valid_build=function(){return t.build.imgUrl?t.build.name?t.build.coordinate?!0:(e({message:"请填写建筑坐标",duration:1e4,classes:"alert-danger"}),!1):(e({message:"请填写建筑名称",duration:1e4,classes:"alert-danger"}),!1):(e({message:"请上传建筑图标",duration:1e4,classes:"alert-danger"}),!1)},t.add_build=function(){if(t.valid_build()){t.isAddBuild=!0;var n={};n.imgUrl=t.build.imgUrl,n.name=t.build.name,n.coordinate=t.build.coordinate,queryService.save({type:"car"},{data:n}).$promise.then(function(n){n.success?(e({message:"添加特殊建筑成功",duration:2e3,classes:"alert-success"}),r.close()):e({message:"添加特殊建筑失败："+n.data,duration:1e4,classes:"alert-danger"}),t.isAddBuild=!1,t.build={imgUrl:"",name:"",coordinate:""}})}},t.del_build=function(t){queryService.remove({type:"car"},{id:t}).$promise.then(function(t){t.success?(e({message:"删除特殊建筑成功",duration:2e3,classes:"alert-success"}),r.close()):e({message:"删除特殊建筑失败："+t.data,duration:1e4,classes:"alert-danger"})})},t.buildEdit={},t.edit_build=function(n){t.editBuildData=n,t.buildEditId=n.id,t.buildEdit={imgUrl:n.imgUrl,name:n.name},r.open({template:"edit_build_dialog",scope:t,className:"ngdialog-theme-default edit_build_dialog",showClose:!0,closeByDocument:!1})},t.edit_upload_build=function(n){n&&a.upload({url:"http://testapi.kids.youku.com/v1/img/upload",method:"POST",data:{image:n}}).then(function(n){var n=n.data;"success"===n.status?(t.buildEdit.imgUrl=n.url,e({message:"图标上传成功",duration:1e4,classes:"alert-success"})):e({message:"图标上传失败",duration:1e4,classes:"alert-danger"})},function(t){e({message:"图标上传失败",duration:1e4,classes:"alert-danger"})},function(t){})},t.update_build=function(){t.editBuildData.imgUrl=t.buildEdit.imgUrl,t.editBuildData.name=t.buildEdit.name,r.close()},t.player={imgUrl:"",name:"",sex:"",phone:"",role:""},t.isAddPlayer=!1,t.query_player=function(){t.players=[{id:"1",imgUrl:"http://picset.tudou.com/2016-04-30/1461998878190-2089056432-diyup.jpg",name:"小明",sex:"男",phone:"123456789",role:"逃亡者"},{id:"2",imgUrl:"http://picset.tudou.com/2016-04-30/1461998878190-2089056432-diyup.jpg",name:"旺财",sex:"女",phone:"546895248",role:"追击者"},{id:"3",imgUrl:"http://picset.tudou.com/2016-04-30/1461998878190-2089056432-diyup.jpg",name:"静静",sex:"女",phone:"7895468924",role:"追击者"}]},t.query_player(),t.upload_player=function(n){n&&a.upload({url:"http://testapi.kids.youku.com/v1/img/upload",method:"POST",data:{image:n}}).then(function(n){var n=n.data;"success"===n.status?(t.player.imgUrl=n.url,e({message:"头像上传成功",duration:1e4,classes:"alert-success"})):e({message:"头像上传失败",duration:1e4,classes:"alert-danger"})},function(t){e({message:"头像上传失败",duration:1e4,classes:"alert-danger"})},function(t){})},t.valid_player=function(){return t.player.imgUrl?t.player.name?t.player.sex?t.player.phone?t.player.role?!0:(e({message:"请填写选手角色",duration:1e4,classes:"alert-danger"}),!1):(e({message:"请填写选手手机号码",duration:1e4,classes:"alert-danger"}),!1):(e({message:"请填写选手性别",duration:1e4,classes:"alert-danger"}),!1):(e({message:"请填写选手姓名",duration:1e4,classes:"alert-danger"}),!1):(e({message:"请上传选手头像",duration:1e4,classes:"alert-danger"}),!1)},t.add_player=function(){if(t.valid_player()){t.isAddPlayer=!0;var n={};n.imgUrl=t.player.imgUrl,n.name=t.player.name,n.sex=t.player.sex,n.phone=t.player.phone,n.role=t.player.role,queryService.save({type:"car"},{data:n}).$promise.then(function(n){n.success?(e({message:"添加选手成功",duration:2e3,classes:"alert-success"}),r.close()):e({message:"添加选手失败："+n.data,duration:1e4,classes:"alert-danger"}),t.isAddPlayer=!1,t.player={imgUrl:"",name:"",sex:"",phone:"",role:""}})}},t.del_player=function(t){queryService.remove({type:"car"},{id:t}).$promise.then(function(t){t.success?(e({message:"删除选手成功",duration:2e3,classes:"alert-success"}),r.close()):e({message:"删除选手失败："+t.data,duration:1e4,classes:"alert-danger"})})},t.playerEdit={},t.edit_player=function(n){t.playerEditId=n.id,t.playerEditData=n,t.playerEdit={imgUrl:n.imgUrl,name:n.name,sex:n.sex,phone:n.phone,role:n.role},r.open({template:"edit_player_dialog",
scope:t,className:"ngdialog-theme-default edit_build_dialog",showClose:!0,closeByDocument:!1})},t.edit_upload_player=function(n){n&&a.upload({url:"http://testapi.kids.youku.com/v1/img/upload",method:"POST",data:{image:n}}).then(function(n){var n=n.data;"success"===n.status?(t.playerEdit.imgUrl=n.url,e({message:"头像上传成功",duration:1e4,classes:"alert-success"})):e({message:"头像上传失败",duration:1e4,classes:"alert-danger"})},function(t){e({message:"头像上传失败",duration:1e4,classes:"alert-danger"})},function(t){})},t.update_player=function(){t.playerEditData.imgUrl=t.playerEdit.imgUrl,t.playerEditData.name=t.playerEdit.name,t.playerEditData.sex=t.playerEdit.sex,t.playerEditData.phone=t.playerEdit.phone,t.playerEditData.role=t.playerEdit.role,r.close()}}]},function(t,n){t.exports='  <div style="width: 100%;max-width: 100%;">\r\n  <table class="table table-hover" style="">\r\n    <thead>\r\n      <tr>\r\n        <th></th>\r\n        <th ng-repeat="data in players">{{data.name}}</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr ng-repeat="player in players">\r\n        <td>{{player.name}}</td>\r\n        <td ng-repeat=" data in datas[$index]">\r\n          <input type="checkbox" class="dpn chk" id="{{data.objectId}}-{{data.subjectId}}" ng-checked="data.checked" ng-model="data.checked" ng-click="edit($event, data)">\r\n          <label for="{{data.objectId}}-{{data.subjectId}}"></label>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n  </div>'},function(t,n){"use strict";t.exports=["$scope","$state","notify","$resource",function(t,n,a,e){t.getUserSet=function(){e("/walker/setting/visible/ ").get({}).$promise.then(function(n){t.players=n.players,t.settings=n.visibleSettings,t.setData()},function(t){a({message:"获取设置失败",duration:1e4,classes:"alert-danger"})})},t.setData=function(){var n=[];angular.forEach(t.players,function(a,e){angular.forEach(t.players,function(s,r){var i=!1,l=!1;angular.forEach(t.settings,function(t,n){i||t.objectId===a.playerid&&t.subjectId===s.playerid&&(l=!!t.visible,i=!0)}),n[e]||(n[e]=[]),n[e].push({name:a.name,objectId:a.playerid,subjectId:s.playerid,checked:l})})}),t.datas=n},t.getUserSet(),t.edit=function(t,n){e("/walker/setting/visible/:objectId/:subjectId/:visible").get({objectId:n.objectId,subjectId:n.subjectId,visible:n.checked?1:0},{}).$promise.then(function(t){a({message:"状态修改成功",duration:1e4,classes:"alert-success"})},function(t){a({message:"状态修改失败",duration:1e4,classes:"alert-danger"}),t.checked=!t.checked})}}]},function(t,n){"use strict";t.exports=function(){return function(t){var n="";return n=t.length<=3?t:t.substring(0,3)+"..."}}},function(t,n){"use strict";t.exports=function(){return function(t){var n=[];return angular.forEach(t,function(t,a,e){t.mixAmount!==t.usedAmount&&n.push(t)}),n}}}]);