!function(t){function a(n){if(e[n])return e[n].exports;var r=e[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}var e={};return a.m=t,a.c=e,a.p="",a(0)}([function(t,a,e){"use strict";angular.module("app",["ui.router","ngResource","ngAnimate","ngFileUpload","cgNotify","ui.bootstrap","ngStorage"]).config(e(1)).run(e(14)).filter("nameFilter",e(15)).filter("toolFilter",e(16))},function(t,a,e){"use strict";t.exports=["$stateProvider","$urlRouterProvider","$httpProvider",function(t,a){a.otherwise(""),t.state("login",{url:"/login",views:{main:{template:e(2),controller:e(3)}}}),t.state("index",{url:"",views:{main:{template:e(4),controller:e(5)}}}).state("index.player",{url:"/player",views:{tab:{template:e(6),controller:e(7)}}}).state("index.setting",{url:"/setting",views:{tab:{template:e(8),controller:e(9)}}}).state("index.saw",{url:"/saw",views:{tab:{template:e(10),controller:e(11)}}}).state("index.tool",{url:"/tool",views:{tab:{template:e(12),controller:e(13)}}})}]},function(t,a){t.exports='<form class="form-horizontal login-form">\r\n  <div class="form-group">\r\n    <label for="username" class="col-sm-2 control-label">用户名</label>\r\n    <div class="col-sm-10">\r\n      <input type="text" class="form-control" id="username" placeholder="请输入用户名" ng-model="user.username">\r\n    </div>\r\n  </div>\r\n  <div class="form-group">\r\n    <label for="password" class="col-sm-2 control-label">密码</label>\r\n    <div class="col-sm-10">\r\n      <input type="password" class="form-control" id="password" placeholder="请输入密码" ng-model="user.password">\r\n    </div>\r\n  </div>\r\n  <div class="form-group">\r\n    <div class="col-sm-offset-2 col-sm-10">\r\n      <button class="btn btn-default" ng-click="login()" ng-keypress="keyLogin($event)">登陆</button>\r\n    </div>\r\n  </div>\r\n</form>'},function(t,a){"use strict";t.exports=["$scope","$state","notify","$resource","$rootScope","$localStorage",function(t,a,e,n,r,s){t.user={},t.keyLogin=function(a){13===a.keyCode&&t.login()},t.login=function(){n("/walker/user/login").save({},t.user,function(t){s.isLogin=!0,a.go("index")},function(t){s.isLogin=!1,e({message:"用户名或密码错误",duration:2e3,classes:"alert-danger"})})}}]},function(t,a){t.exports='<div class="content-title">\r\n  <ul class="nav nav-pills">\r\n    <li ng-class="sref==\'index.player\'? \'active\' : \'default\'" ng-click="change($event)">\r\n      <a ui-sref="index.player">选手看板设置</a>\r\n    </li>\r\n    <li ng-class="sref==\'index.setting\'? \'active\' : \'default\'" ng-click="change($event)">\r\n      <a ui-sref="index.setting">活动设置</a>\r\n    </li>\r\n    <li ng-class="sref==\'index.saw\'? \'active\' : \'default\'" ng-click="change($event)">\r\n      <a ui-sref="index.saw">可见设置</a>\r\n    </li>\r\n    <li ng-class="sref==\'index.tool\'? \'active\' : \'default\'" ng-click="change($event)">\r\n      <a ui-sref="index.tool">道具设置</a>\r\n    </li>\r\n  </ul>\r\n  <span class="pull-right logout" ng-show="isLogin">\r\n    <a href="javascript:;" ng-click="logout()">注销</a>\r\n  </span>\r\n</div>\r\n<div class="content-ad">\r\n  <div class="row">\r\n    <div class="col-sm-3"></div>\r\n    <div class="col-sm-6">\r\n      <div class="input-group">\r\n        <input type="text" class="form-control ad-input" placeholder="公告输入" ng-model="notice">\r\n        <span class="input-group-btn">\r\n          <button class="btn btn-oppo" type="button" ng-click="sendNotice()">发送公告</button>\r\n        </span>\r\n      </div>\r\n    </div>\r\n    <div class="col-sm-3">\r\n      <div class="input-group">\r\n        <span class="input-group-btn">\r\n          <button class="btn btn-oppo" type="button" ng-click="seeNotice()">查看公告</button>\r\n        </span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div class="tab-content">\r\n  <div ui-view="tab"></div>\r\n</div>\r\n<script type="text/ng-template" id="notice_dialog">\r\n  <div class="modal-body">\r\n    <div class="alert" ng-class="{\'alert-success\': $odd, \'alert-info\': $even}" ng-repeat="data in noticeList">\r\n      {{data.create_time}} : {{data.content}}\r\n    </div>\r\n  </div>\r\n</script>'},function(t,a){"use strict";t.exports=["$scope","$state","notify","$resource","$uibModal","$localStorage","$rootScope",function(t,a,e,n,r,s,l){t.isLogin=s.isLogin,s.isLogin||l.out(),"index"===a.current.name?(a.go("index.player"),t.sref="index.player"):t.sref=a.current.name,t.change=function(a){t.sref=a.target.getAttribute("ui-sref")},t.sendNotice=function(){return t.notice?void n("/walker/setting/notification/ ").save({},t.notice).$promise.then(function(t){401===t.code?l.out():e({message:"公告发送成功",duration:1e4,classes:"alert-success"})},function(t){l.out(),e({message:"公告发送失败",duration:1e4,classes:"alert-danger"})}):(e({message:"请填写公告",duration:1e4,classes:"alert-danger"}),!1)},t.seeNotice=function(){n("/walker/setting/notification/ ").query(function(a){401===a.code?l.out():(t.noticeList=a,t.showNotice())},function(t){l.out(),e({message:"获取公告失败",duration:1e4,classes:"alert-danger"})})},t.showNotice=function(){r.open({templateUrl:"notice_dialog",scope:t,size:"notice-dialog"})},t.logout=function(){n("/walker/user/logout").get(function(t){l.out()},function(t){l.out()})}}]},function(t,a){t.exports='<div class="row">\r\n  <button class="btn btn-primary ml20" ng-click="getPlayers()">刷新（每30s自动刷新一次）</button>\r\n</div>\r\n<div class="row">\r\n  <div class="content-content content-content-list1" ng-repeat="data in list1">\r\n    <div class="row content-content-1">\r\n      <div class="col-sm-8">\r\n        <div class="img img-list1">\r\n          <img ng-src="{{data.player.avatar}}" alt="" class="avatar">\r\n          <div class="name" title="{{data.player.name}}">{{data.player.name | nameFilter}}</div>\r\n          <div class="count">{{data.player.audience}}人</div>\r\n        </div>\r\n      </div>\r\n      <div class="col-sm-4">\r\n        <div class="remark remark-list1">{{data.player.role}}</div>\r\n        <div class="remark remark-list1">{{data.player.status}}</div>\r\n      </div>\r\n    </div>\r\n    <div class="content-content-2">\r\n      <div class="row color1">\r\n        <div class="col-sm-3">人气值</div>\r\n        <div class="col-sm-3">排名</div>\r\n        <div class="col-sm-3">金币</div>\r\n        <div class="col-sm-3">排名</div>\r\n      </div>\r\n      <div class="row color2 rank-list1">\r\n        <div class="col-sm-3">{{data.player.money}}</div>\r\n        <div class="col-sm-3">{{data.player.moneyRank}}</div>\r\n        <div class="col-sm-3">{{data.player.tudou}}</div>\r\n        <div class="col-sm-3">{{data.player.rank}}</div>\r\n      </div>\r\n    </div>\r\n    <div class="content-content-3">\r\n      <div class="row edit-info" ng-click="editInfo(data)">\r\n        修改信息\r\n      </div>\r\n    </div>\r\n    <div class="content-content-4">\r\n      <div class="row content-content-4-list" ng-repeat="data in data.items | toolFilter">\r\n        <div class="col-sm-4">\r\n          <img class="tools" ng-src="{{data.picUrl}}" alt="" title="{{data.title}}">\r\n        </div>\r\n        <div class="col-sm-4">\r\n          {{data.usedAmount}}\r\n        </div>\r\n        <div class="col-sm-4">\r\n          {{data.mixAmount}}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div class="row">\r\n  <div class="content-content" ng-repeat="data in list2">\r\n    <div class="row content-content-1">\r\n      <div class="col-sm-8">\r\n        <div class="img">\r\n          <img ng-src="{{data.player.avatar}}" alt="" class="avatar">\r\n          <div class="name" title="{{data.player.name}}">{{data.player.name | nameFilter}}</div>\r\n          <div class="count">{{data.player.audience}}人</div>\r\n        </div>\r\n      </div>\r\n      <div class="col-sm-4">\r\n        <div class="remark">{{data.player.role}}</div>\r\n        <div class="remark">{{data.player.status}}</div>\r\n      </div>\r\n    </div>\r\n    <div class="content-content-2">\r\n      <div class="row color1">\r\n        <div class="col-sm-3">人气值</div>\r\n        <div class="col-sm-3">排名</div>\r\n        <div class="col-sm-3">金币</div>\r\n        <div class="col-sm-3">排名</div>\r\n      </div>\r\n      <div class="row color2">\r\n        <div class="col-sm-3">{{data.player.money}}</div>\r\n        <div class="col-sm-3">{{data.player.moneyRank}}</div>\r\n        <div class="col-sm-3">{{data.player.tudou}}</div>\r\n        <div class="col-sm-3">{{data.player.rank}}</div>\r\n      </div>\r\n    </div>\r\n    <div class="content-content-3">\r\n      <div class="row edit-info" ng-click="editInfo(data)">\r\n        修改信息\r\n      </div>\r\n    </div>\r\n    <div class="content-content-4">\r\n      <div class="row content-content-4-list" ng-repeat="data in data.items | toolFilter">\r\n        <div class="col-sm-4">\r\n          <img class="tools" ng-src="{{data.picUrl}}" alt="" title="{{data.title}}">\r\n        </div>\r\n        <div class="col-sm-4">\r\n          {{data.usedAmount}}\r\n        </div>\r\n        <div class="col-sm-4">\r\n          {{data.mixAmount}}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div class="row">\r\n  <div class="content-content content-content-list3" ng-repeat="data in list3">\r\n    <div class="row content-content-1">\r\n      <div class="col-sm-8">\r\n        <div class="img img-list3">\r\n          <img ng-src="{{data.player.avatar}}" alt="" class="avatar">\r\n          <div class="name" title="{{data.player.name}}">{{data.player.name | nameFilter}}</div>\r\n          <div class="count">{{data.player.audience}}人</div>\r\n        </div>\r\n      </div>\r\n      <div class="col-sm-4">\r\n        <div class="remark remark-list3">{{data.player.role}}</div>\r\n        <div class="remark remark-list3">{{data.player.status}}</div>\r\n      </div>\r\n    </div>\r\n    <div class="content-content-2">\r\n      <div class="row">\r\n        <div class="col-sm-3">人气值</div>\r\n        <div class="col-sm-3">排名</div>\r\n        <div class="col-sm-3">金币</div>\r\n        <div class="col-sm-3">排名</div>\r\n      </div>\r\n      <div class="row color2 rank-list3">\r\n        <div class="col-sm-3">{{data.player.money}}</div>\r\n        <div class="col-sm-3">{{data.player.moneyRank}}</div>\r\n        <div class="col-sm-3">{{data.player.tudou}}</div>\r\n        <div class="col-sm-3">{{data.player.rank}}</div>\r\n      </div>\r\n    </div>\r\n    <div class="content-content-3">\r\n      <div class="row edit-info" ng-click="editInfo(data)">\r\n        修改信息\r\n      </div>\r\n    </div>\r\n    <div class="content-content-4">\r\n      <div class="row content-content-4-list" ng-repeat="data in data.items | toolFilter">\r\n        <div class="col-sm-4">\r\n          <img class="tools" ng-src="{{data.picUrl}}" alt="" title="{{data.title}}">\r\n        </div>\r\n        <div class="col-sm-4">\r\n          {{data.usedAmount}}\r\n        </div>\r\n        <div class="col-sm-4">\r\n          {{data.mixAmount}}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<script type="text/ng-template" id="dialog">\r\n  <div class="row dialog-layer-1">\r\n    <div class="col-sm-2">\r\n      <div class="img">\r\n        <img ng-src="{{editData.player.avatar}}" alt="" class="avatar">\r\n        <div>{{editData.player.name | nameFilter}}</div>\r\n        <div>{{editData.player.audience}}人</div>\r\n      </div>\r\n    </div>\r\n    <div class="col-sm-2 remark">\r\n     <div>{{editData.player.role}}</div>\r\n     <div>{{editData.player.status}}</div>\r\n    </div>\r\n    <div class="col-sm-8">\r\n      <div class="row color1">\r\n        <div class="col-sm-3">人气值</div>\r\n        <div class="col-sm-3">排名</div>\r\n        <div class="col-sm-3">金币</div>\r\n        <div class="col-sm-3">排名</div>\r\n      </div>\r\n      <div class="row color2">\r\n        <div class="col-sm-3">{{editData.player.money}}</div>\r\n        <div class="col-sm-3">{{editData.player.moneyRank}}</div>\r\n        <div class="col-sm-3">\r\n          <span ng-hide="isEditTuDou" class="crp" ng-click="showEditTuDou()">{{editData.player.tudou}}</span>\r\n          <span ng-show="isEditTuDou">\r\n            <input type="text"class="form-control" ng-model="editData.player.edit_tuDou">\r\n          </span>\r\n          <span class="btn-group" ng-show="isEditTuDou">\r\n            <button class="btn btn-dialog-2 edit-tudou" ng-click="editTuDou()">增加</button>\r\n            <button class="btn btn-dialog-2 edit-tudou" ng-click="cancle_editTuDou()">取消</button>\r\n          </span>\r\n        </div>\r\n        <div class="col-sm-3">{{editData.player.rank}}</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="row dialog-layer-2">\r\n    <div class="col-sm-6">\r\n      <div class="row">\r\n        <div class="col-sm-3">\r\n          角色\r\n        </div>\r\n        <div class="col-sm-4">\r\n          <select class="form-control select-check" ng-options="role.name as role.name for role in roleList" ng-model="editData.player.role">\r\n          </select>\r\n        </div>\r\n        <div class="col-sm-2">\r\n        </div>\r\n        <div class="col-sm-3 dialog-layer-2-line">\r\n          <button class="btn btn-dialog-2" ng-click="editRole()">确定</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class="col-sm-6">\r\n      <div class="row">\r\n        <div class="col-sm-3">\r\n          状态\r\n        </div>\r\n        <div class="col-sm-4">\r\n          <select class="form-control select-check" ng-options="status.name as status.name for status in statusList" ng-model="editData.player.status">\r\n          </select>\r\n        </div>\r\n        <div class="col-sm-2">\r\n        </div>\r\n        <div class="col-sm-3">\r\n          <button class="btn btn-dialog-2" ng-click="editStatus()">确定</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="row dialog-layer-3">\r\n    <div class="mt30">\r\n      <div class="wd50 fl" ng-repeat="data in editData.items | orderBy:\'playerNeed\':true">\r\n        <div class="col-sm-1 mt15">\r\n          <span ng-if="data.playerNeed !== 0" class="need">急</span>\r\n        </div>\r\n        <div class="col-sm-2">\r\n          <img src="" alt="" class="avatar" ng-src="{{data.picUrl}}" title="{{data.title}}">\r\n        </div>\r\n        <div class="col-sm-4">\r\n          <div class="progress mt16">\r\n            <div class="progress-bar progress-bar-danger progress-bar-striped" role="progressbar" aria-valuenow="80" aria-valuemin="0"\r\n              aria-valuemax="100" \r\n              ng-class="{\'wd0\': (data.currentAmount/data.fundTotalAmount < 0.2), \'wd20\': (data.currentAmount/data.fundTotalAmount < 0.4 && data.currentAmount/data.fundTotalAmount >= 0.2), \r\n              \'wd40\': (data.currentAmount/data.fundTotalAmount < 0.6 && data.currentAmount/data.fundTotalAmount >= 0.4), \'wd60\': (data.currentAmount/data.fundTotalAmount < 0.8 && data.currentAmount/data.fundTotalAmount >= 0.6),\r\n              \'wd80\': (data.currentAmount/data.fundTotalAmount < 1 && data.currentAmount/data.fundTotalAmount >= 0.8), \'wd100\': (data.currentAmount/data.fundTotalAmount == 1)}">\r\n              <span class="sr-only">80% Complete (danger)</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class="col-sm-2 ml20 crp mt12" ng-click="showInput(data)" ng-hide="data.isClick">{{data.usedAmount}}/{{data.mixAmount}}</div>\r\n        <div class="col-sm-2 ml20 mt7">\r\n          <input type="text" class="form-control" ng-model="data.usedAmount" ng-show="data.isClick">\r\n        </div>\r\n        <div class="col-sm-1 mt7">\r\n          <button class="btn btn-default" ng-show="data.isClick" ng-click="editNum(editData, data)">确定</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</script>'},function(t,a){"use strict";t.exports=["$scope","$rootScope","notify","$resource","$interval","$uibModal","$localStorage",function(t,a,e,n,r,s,l){l.isLogin||a.out(),t.getPlayers=function(){n("/walker/player/list").get(function(e){401===e.code?a.out():(t.list1=e["猫"],t.list2=e["鼠"],t.list3=e["候补者"])},function(t){e({message:"获取数据失败,请刷新",duration:1e4,classes:"alert-danger"})})},t.getPlayers(),a.timer=r(t.getPlayers,3e4),t.editInfo=function(r){t.editDataOrigin=r,n("/walker/player/:id").get({id:r.player.playerid},function(e){401===e.code?a.out():(t.editData=e,t.isShowDiv=!0,s.open({templateUrl:"dialog",scope:t,size:"md"}))},function(t){e({message:"获取数据失败,请刷新",duration:1e4,classes:"alert-danger"})})},t.roleList=[{name:"鼠"},{name:"猫"},{name:"候补者"}],t.statusList=[{name:"活跃状态"},{name:"监狱状态"},{name:"待激活状态"}],t.editRole=function(){n("/walker/player/:id").save({id:t.editData.player.playerid},{role:t.editData.player.role},function(n){401===n.code?a.out():(e({message:"角色修改成功",duration:1e4,classes:"alert-success"}),t.getPlayers())},function(t){e({message:"角色修改失败",duration:1e4,classes:"alert-danger"})})},t.editStatus=function(){n("/walker/player/:id").save({id:t.editData.player.playerid},{status:t.editData.player.status}).$promise.then(function(n){401===n.code?a.out():(e({message:"状态修改成功",duration:1e4,classes:"alert-success"}),t.editDataOrigin.player.status=t.editData.player.status)},function(t){e({message:"状态修改失败",duration:1e4,classes:"alert-danger"})})},t.showInput=function(t){t.isClick=!0},t.editNum=function(r,s){n("/walker/player/:id/:itemId").save({id:r.player.playerid,itemId:s.itemId},{usedAmount:parseInt(s.usedAmount,10)}).$promise.then(function(n){401===n.code?a.out():(e({message:"数目修改成功",duration:1e4,classes:"alert-success"}),s.isClick=!1,t.getPlayers())},function(t){e({message:"数目修改失败",duration:1e4,classes:"alert-danger"})})},t.isEditTuDou=!1,t.showEditTuDou=function(){t.isEditTuDou=!0,t.editData.player.edit_tuDou=0},t.editTuDou=function(){n("/walker/player/:id").save({id:t.editData.player.playerid},{tudou:parseInt(t.editData.player.edit_tuDou,10)}).$promise.then(function(n){401===n.code?a.out():(e({message:"金币修改成功",duration:1e4,classes:"alert-success"}),t.editData.player.tudou=parseInt(t.editData.player.tudou,10)+parseInt(t.editData.player.edit_tuDou,10),t.editDataOrigin.player.tudou=t.editData.player.tudou,t.isEditTuDou=!1,t.getPlayers())},function(t){e({message:"金币修改失败",duration:1e4,classes:"alert-danger"})})},t.cancle_editTuDou=function(){t.isEditTuDou=!1}}]},function(t,a){t.exports='<div class="set">\r\n  <div class="role-set">地图元素维护</div>\r\n  <div class="map-title-set">系统设置</div>\r\n  <table class="table map-table table-hover">\r\n    <thead>\r\n      <tr>\r\n        <th class="">区域中心</th>\r\n        <th class="">半径（米）</th>\r\n        <th class="">观众美化系数（乘）</th>\r\n        <th class="">观众美化系数（加）</th>\r\n        <th class="">距离提醒（开关）</th>\r\n        <th class="">距离提醒（距离）</th>\r\n        <th class="">操作</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr>\r\n        <td>\r\n          <span>{{settings.center.lng}},{{settings.center.lat}}</span>\r\n          <span name="edit_map" class="glyphicon glyphicon-map-marker set-font-size" title="点击修改坐标" ng-click="show_map_dialog(settings)"></span>\r\n        </td>\r\n        <td>\r\n          <span>{{settings.radius}}</span>\r\n        </td>\r\n        <td>\r\n          <span>{{settings.mul}}</span>\r\n        </td>\r\n        <td>\r\n          <span>{{settings.add}}</span>\r\n        </td>\r\n        <td>\r\n          <span>{{settings.distanceWarning.warningSwitch === \'on\' ? \'开\' : \'关\'}}</span>\r\n        </td>\r\n        <td>\r\n          <span>{{settings.distanceWarning.distance}}</span>\r\n        </td>\r\n        <td>\r\n          <a href="javascript:;" ng-click="edit_setting()">修改</a>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n  <div class="map-title-set">特殊建筑维护</div>\r\n  <table class="table map-table table-hover">\r\n    <thead>\r\n      <tr>\r\n        <th class="wd10">建筑图标</th>\r\n        <th class="wd14">建筑编号</th>\r\n        <th class="wd14">名称</th>\r\n        <th class="wd14">角色</th>\r\n        <th class="wd14">电话号码</th>\r\n        <th class="wd20">坐标</th>\r\n        <th class="wd14">操作</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr ng-repeat="data in buildings">\r\n        <td><img src="" alt="" ng-src="{{data.avatar}}"></td>\r\n        <td>{{data.playerid}}</td>\r\n        <td>{{data.name}}</td>\r\n        <td>{{data.role}}</td>\r\n        <td>{{data.tel}}</td>\r\n        <td>\r\n          <span>{{data.lng}}, {{data.lat}}</span>\r\n          <span name="edit_map" class="glyphicon glyphicon-map-marker set-font-size" title="点击修改坐标" ng-click="show_map_dialog(data)"></span>\r\n        </td>\r\n        <td>\r\n          <a href="javascript:;" ng-click="edit_build(data)">修改</a>\r\n          <a class="btn-del" href="javascript:;" ng-click="del_build(data.playerid)">删除</a>\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td>\r\n          <img src="" alt="" ng-src="{{build.avatar}}">\r\n          <div class="upload" type="file" ngf-select="upload_build($file)" accept="image/*" ngf-max-height="100000" ngf-max-size="10MB">上传图标</div>\r\n        </td>\r\n        <td><input type="text" class="form-control" placeholder="请输入playerid" ng-model="build.playerid"></td>\r\n        <td><input type="text" class="form-control" placeholder="请输入名称" ng-model="build.name"></td>\r\n        <td>\r\n          <select class="form-control" ng-options="role.name as role.name for role in roleList" ng-model="build.role"></select>\r\n        </td>\r\n        <td>\r\n          <input type="text" class="form-control" placeholder="请输入电话号码" ng-model="build.tel">\r\n        </td>\r\n        <td>\r\n          <span>{{build.lng}}, {{build.lat}}</span>\r\n          <span class="glyphicon glyphicon-map-marker set-font-size" title="点击设置坐标" ng-click="show_map_dialog(data)"></span>\r\n        </td>\r\n        <td>\r\n          <button class="btn btn-oppo" ng-click="add_build()" ng-disabled="isAddBuild">添加特殊建筑</button>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n  <div class="map-title-set">选手维护</div>\r\n  <table class="table map-table table-hover">\r\n    <thead>\r\n      <tr>\r\n        <th>头像</th>\r\n        <th>姓名</th>\r\n        <th>手机号</th>\r\n        <th>角色</th>\r\n        <th>操作</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr ng-repeat="data in players">\r\n        <td class="wd18">\r\n          <img ng-src="{{data.avatar}}" alt="">\r\n        </td>\r\n        <td class="wd20">{{data.name}}</td>\r\n        <td class="wd20">{{data.tel}}</td>\r\n        <td class="wd20">{{data.role}}</td>\r\n        <td class="wd22">\r\n          <a href="javascript:;" ng-click="edit_player(data)">修改</a>\r\n          <a class="btn-del" href="javascript:;" ng-click="del_player(data.playerid)">删除</a>\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td></td>\r\n        <td></td>\r\n        <td></td>\r\n        <td></td>\r\n        <td>\r\n          <button class="btn btn-oppo" ng-click="add_player_dialog()">添加选手</button>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n<!--区域设置 修改框-->\r\n<script type="text/ng-template" id="edit_setting_dialog">\r\n  <div class="modal-body">\r\n    <div class="row mb10">\r\n      <label class="col-sm-4 mt7">半径</label>\r\n      <div class="col-sm-8">\r\n        <input type="text" class="form-control" placeholder="请输入半径" ng-model="settingEdit.radius">\r\n      </div>\r\n    </div>\r\n    <div class="row mb10">\r\n      <label class="col-sm-4 mt7">美化系数（乘）</label>\r\n      <div class="col-sm-8">\r\n        <input type="text" class="form-control" placeholder="请输入美化系数" ng-model="settingEdit.mul">\r\n      </div>\r\n    </div>\r\n    <div class="row mb10">\r\n      <label class="col-sm-4 mt7">美化系数（加）</label>\r\n      <div class="col-sm-8">\r\n        <input type="text" class="form-control" placeholder="请输入美化系数" ng-model="settingEdit.add">\r\n      </div>\r\n    </div>\r\n    <div class="row mb10">\r\n      <label class="col-sm-4 mt7">距离提醒（开关）</label>\r\n      <div class="col-sm-8">\r\n        <select class="form-control" ng-model="settingEdit.switch">\r\n          <option value="on">开</option>\r\n          <option value="off">关</option>\r\n        </select>\r\n      </div>\r\n    </div>\r\n    <div class="row mb10">\r\n      <label class="col-sm-4 mt7">距离提醒（距离）（米）</label>\r\n      <div class="col-sm-8">\r\n        <input type="text" class="form-control" placeholder="请输入距离" ng-model="settingEdit.distance">\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="modal-footer">\r\n    <button class="btn btn-oppo" ng-click="close()">关闭</button>\r\n    <button class="btn btn-oppo" ng-click="update_setting()">保存</button>\r\n  </div>\r\n</script>\r\n<!--特殊建筑维护 修改框-->\r\n<script type="text/ng-template" id="edit_build_dialog">\r\n  <div class="modal-body">\r\n    <div class="row mt15 mb10">\r\n      <label class="col-sm-3 mt15">建筑图标</label>\r\n      <div class="col-sm-9">\r\n        <img src="" alt="" ng-src="{{buildEdit.avatar}}">\r\n        <div class="upload dialog-upload" type="file" ngf-select="edit_upload_build($file)" accept="image/*" ngf-max-height="100000"\r\n          ngf-max-size="10MB">上传图标</div>\r\n      </div>\r\n    </div>\r\n    <div class="row mb10">\r\n      <label class="col-sm-3 mt7">名称</label>\r\n      <div class="col-sm-9">\r\n        <input type="text" class="form-control" placeholder="请输入名称" ng-model="buildEdit.name">\r\n      </div>\r\n    </div>\r\n    <div class="row mb10">\r\n      <label class="col-sm-3 mt7">电话</label>\r\n      <div class="col-sm-9">\r\n        <input type="text" class="form-control" placeholder="请输入电话" ng-model="buildEdit.tel">\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="modal-footer">\r\n    <button class="btn btn-oppo" ng-click="close()">关闭</button>\r\n    <button class="btn btn-oppo" ng-click="update_build()">保存</button>\r\n  </div>\r\n</script>\r\n<!--选手维护 增加框-->\r\n<script type="text/ng-template" id="add_player_dialog">\r\n  <div class="modal-body">\r\n    <div class="row mb10">\r\n      <label class="col-sm-3 mt15">选手头像</label>\r\n      <div class="col-sm-9">\r\n        <img src="" alt="" ng-src="{{player.avatar}}">\r\n        <div class="upload dialog-upload" type="file" ngf-select="upload_player($file)" accept="image/*" ngf-max-height="100000"\r\n          ngf-max-size="10MB">上传头像</div>\r\n      </div>\r\n    </div>\r\n    <div class="row mb10">\r\n      <label class="col-sm-3 mt7">直播url</label>\r\n      <div class="col-sm-9">\r\n        <input type="text" class="form-control" placeholder="请输入直播地址" ng-model="player.zburl">\r\n      </div>\r\n    </div>\r\n    <div class="row mb10">\r\n      <label class="col-sm-3 mt7">选手id</label>\r\n      <div class="col-sm-9">\r\n        <input type="text" class="form-control" placeholder="请输入选手id" ng-model="player.playerid">\r\n      </div>\r\n    </div>\r\n    <div class="row mb10">\r\n      <label class="col-sm-3 mt7">房间id</label>\r\n      <div class="col-sm-9">\r\n        <input type="text" class="form-control" placeholder="请输入房间id" ng-model="player.zbid">\r\n      </div>\r\n    </div>\r\n    <div class="row mb10">\r\n      <label class="col-sm-3 mt7">姓名</label>\r\n      <div class="col-sm-9">\r\n        <input type="text" class="form-control" placeholder="请输入姓名" ng-model="player.name">\r\n      </div>\r\n    </div>\r\n    <div class="row mb10">\r\n      <label class="col-sm-3 mt7">手机号</label>\r\n      <div class="col-sm-9">\r\n        <input type="text" class="form-control" placeholder="请输入手机号" ng-model="player.tel">\r\n      </div>\r\n    </div>\r\n    <div class="row mb10">\r\n      <label class="col-sm-3 mt7">角色</label>\r\n      <div class="col-sm-9">\r\n        <select class="form-control" ng-model="player.role">\r\n        <option value="鼠">鼠</option>\r\n        <option value="猫">猫</option>\r\n        <option value="候补者">候补者</option>\r\n      </select>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="modal-footer">\r\n    <button class="btn btn-oppo" ng-click="close()">关闭</button>\r\n    <button class="btn btn-oppo" ng-click="add_player()" ng-disabled="isAddPlayer">保存</button>\r\n  </div>\r\n</script>\r\n<!--选手维护 修改框-->\r\n<script type="text/ng-template" id="edit_player_dialog">\r\n  <div class="modal-body">\r\n    <div class="row mb10">\r\n      <label class="col-sm-3 mt15">选手头像</label>\r\n      <div class="col-sm-9">\r\n        <img src="" alt="" ng-src="{{playerEdit.avatar}}">\r\n        <div class="upload dialog-upload" type="file" ngf-select="edit_upload_player($file)" accept="image/*" ngf-max-height="100000"\r\n          ngf-max-size="10MB">上传头像</div>\r\n      </div>\r\n    </div>\r\n    <div class="row mb10">\r\n      <label class="col-sm-3 mt7">直播url</label>\r\n      <div class="col-sm-9">\r\n        <input type="text" class="form-control" placeholder="请输入直播地址" ng-model="playerEdit.zburl">\r\n      </div>\r\n    </div>\r\n    <div class="row mb10">\r\n      <label class="col-sm-3 mt7">选手id</label>\r\n      <div class="col-sm-9">\r\n        <input type="text" class="form-control" placeholder="请输入选手id" ng-model="playerEdit.playerid">\r\n      </div>\r\n    </div>\r\n    <div class="row mb10">\r\n      <label class="col-sm-3 mt7">房间id</label>\r\n      <div class="col-sm-9">\r\n        <input type="text" class="form-control" placeholder="请输入房间id" ng-model="playerEdit.zbid">\r\n      </div>\r\n    </div>\r\n    <div class="row mb10">\r\n      <label class="col-sm-3 mt7">姓名</label>\r\n      <div class="col-sm-9">\r\n        <input type="text" class="form-control" placeholder="请输入姓名" ng-model="playerEdit.name">\r\n      </div>\r\n    </div>\r\n    <div class="row mb10">\r\n      <label class="col-sm-3 mt7">手机号</label>\r\n      <div class="col-sm-9">\r\n        <input type="text" class="form-control" placeholder="请输入手机号" ng-model="playerEdit.tel">\r\n      </div>\r\n    </div>\r\n    <div class="row mb10">\r\n      <label class="col-sm-3 mt7">角色</label>\r\n      <div class="col-sm-9">\r\n        <select class="form-control" ng-model="playerEdit.role">\r\n        <option value="鼠">鼠</option>\r\n        <option value="猫">猫</option>\r\n        <option value="候补者">候补者</option>\r\n      </select>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="modal-footer">\r\n    <button class="btn btn-oppo" ng-click="close()">关闭</button>\r\n    <button class="btn btn-oppo" ng-click="update_player()">保存</button>\r\n  </div>\r\n</script>\r\n<!--地图 -->\r\n<script type="text/ng-template" id="map_dialog">\r\n  <div class="modal-body">\r\n    <div class="map" id="mapContainer"></div>\r\n  </div>\r\n  <div class="modal-footer">\r\n    <button class="btn btn-oppo" ng-click="close()">关闭</button>\r\n    <button class="btn btn-oppo" ng-click="set_map_position()">保存</button>\r\n  </div>\r\n</script>\r\n<!--删除 建筑 -->\r\n<script type="text/ng-template" id="remove_build_dialog">\r\n  <div class="modal-body">\r\n    确认删除该建筑数据吗？\r\n  </div>\r\n  <div class="modal-footer">\r\n    <button class="btn btn-oppo" ng-click="close()">关闭</button>\r\n    <button class="btn btn-oppo" ng-click="remove_build()">确认</button>\r\n  </div>\r\n</script>\r\n<!--删除 选手 -->\r\n<script type="text/ng-template" id="remove_player_dialog">\r\n  <div class="modal-body">\r\n    确认删除改选手数据吗？\r\n  </div>\r\n  <div class="modal-footer">\r\n    <button class="btn btn-oppo" ng-click="close()">关闭</button>\r\n    <button class="btn btn-oppo" ng-click="remove_player()">确认</button>\r\n  </div>\r\n</script>'},function(t,a){"use strict";t.exports=["$scope","$state","Upload","notify","$resource","$uibModal","$rootScope","$localStorage",function(t,a,e,n,r,s,l,i){i.isLogin||l.out(),t.clickPosition=null,t.show_map_dialog=function(a){a&&a.lng&&a.lat?(t.editBuildData=a,t.edit_build_mode=!0):a&&a.center&&(t.editSettingData=a,t.edit_setting_mode=!0),t.modal=s.open({templateUrl:"map_dialog",scope:t,size:"md"}),t.modal.rendered.then(function(){var a=new AMap.Map("mapContainer");if(a.r){if(a.setZoom(14),t.edit_build_mode){var e=new AMap.LngLat(t.editBuildData.lng,t.editBuildData.lat);
a.setCenter([t.editBuildData.lng,t.editBuildData.lat]),new AMap.Marker({position:e,map:a})}else if(t.edit_setting_mode){var e=new AMap.LngLat(t.editSettingData.center.lng,t.editSettingData.center.lat);a.setCenter([t.editSettingData.center.lng,t.editSettingData.center.lat]),new AMap.Marker({position:e,map:a})}else a.setCenter([t.settings.center.lng,t.settings.center.lat]);var n=function(e){a.clearMap(),new AMap.Marker({position:e.lnglat,map:a}),t.clickPositionLng=e.lnglat.lng,t.clickPositionLat=e.lnglat.lat};a.on("click",n)}}),t.modal.closed.then(function(){t.edit_setting_mode=!1,t.edit_build_mode=!1})},t.set_map_position=function(){t.edit_build_mode?r("/walker/player/:id").save({id:t.editBuildData.playerid},{lng:t.clickPositionLng+"",lat:t.clickPositionLat+""}).$promise.then(function(a){401===a.code?l.out():(t.editBuildData.lng=t.clickPositionLng+"",t.editBuildData.lat=t.clickPositionLat+"",t.edit_build_mode=!1,n({message:"修改成功",duration:1e4,classes:"alert-success"}),t.modal.close())},function(t){n({message:"出错啦",duration:1e4,classes:"alert-danger"})}):t.edit_setting_mode?r("/walker/setting/ ").save({},{centerLng:t.clickPositionLng+"",centerLat:t.clickPositionLat+""}).$promise.then(function(a){401===a.code?l.out():(t.settings.center.lng=t.clickPositionLng+"",t.settings.center.lat=t.clickPositionLat+"",t.edit_setting_mode=!1,n({message:"修改成功",duration:1e4,classes:"alert-success"}),t.modal.close())},function(t){n({message:"出错啦",duration:1e4,classes:"alert-danger"})}):(t.build.lng=t.clickPositionLng,t.build.lat=t.clickPositionLat,t.modal.close())},t.query_setting=function(){r("/walker/setting/ ").get().$promise.then(function(a){401===a.code?l.out():t.settings=a},function(t){n({message:"出错啦",duration:1e4,classes:"alert-danger"})})},t.query_setting(),t.edit_setting=function(){var a=t.settings;t.settingEdit={radius:a.radius,mul:a.mul,add:a.add,"switch":a.distanceWarning.warningSwitch,distance:a.distanceWarning.distance},t.modal=s.open({templateUrl:"edit_setting_dialog",scope:t,size:"edit-setting-dialog"})},t.update_setting=function(){var a=t.settingEdit;r("/walker/setting/ ").save({},{radius:parseInt(a.radius),add:parseInt(a.add),mul:parseInt(a.mul),warningSwitch:a["switch"],warningDistance:parseInt(a.distance)}).$promise.then(function(e){401===e.code?l.out():(t.settings.radius=a.radius,t.settings.add=a.add,t.settings.mul=a.mul,t.settings.distanceWarning.warningSwitch=a["switch"],t.settings.distanceWarning.distance=a.distance,n({message:"修改成功",duration:1e4,classes:"alert-success"}),t.modal.close())},function(t){n({message:"出错啦",duration:1e4,classes:"alert-danger"})})},t.roleList=[{name:"基地"},{name:"监狱"},{name:"赌场"},{name:"安全屋"},{name:"角斗场"},{name:"移动商贩"},{name:"天眼"}],t.build={playerid:"",zbid:"",avatar:"",name:"",role:"",tel:"",lng:"",lat:""},t.isAddBuild=!1,t.query_build=function(){r("/walker/player/building/list").query({}).$promise.then(function(a){401===a.code?l.out():t.buildings=a},function(t){n({message:"出错啦",duration:1e4,classes:"alert-danger"})})},t.query_build(),t.upload_build=function(a){a&&e.upload({url:"/v1/img/upload",method:"POST",data:{image:a}}).then(function(a){var a=a.data;"success"===a.status?(t.build.avatar=a.url,n({message:"图标上传成功",duration:1e4,classes:"alert-success"})):n({message:"图标上传失败",duration:1e4,classes:"alert-danger"})},function(t){n({message:"图标上传失败",duration:1e4,classes:"alert-danger"})},function(t){})},t.valid_build=function(){return t.build.avatar?t.build.playerid?t.build.name?t.build.role?t.build.tel?t.build.lng&&t.build.lat?!0:(n({message:"请填写建筑坐标",duration:1e4,classes:"alert-danger"}),!1):(n({message:"请填写电话",duration:1e4,classes:"alert-danger"}),!1):(n({message:"请填写建筑角色",duration:1e4,classes:"alert-danger"}),!1):(n({message:"请填写建筑名称",duration:1e4,classes:"alert-danger"}),!1):(n({message:"请填写建筑id",duration:1e4,classes:"alert-danger"}),!1):(n({message:"请上传建筑图标",duration:1e4,classes:"alert-danger"}),!1)},t.add_build=function(){if(t.valid_build()){t.isAddBuild=!0;var a={};a.playerid=t.build.playerid,a.zbid=t.build.playerid,10,a.avatar=t.build.avatar,a.name=t.build.name,a.role=t.build.role,a.tel=t.build.tel,a.lng=t.build.lng+"",a.lat=t.build.lat+"",r("/walker/player/ ",{},{put:{method:"PUT",isArray:!1}}).put({},a).$promise.then(function(a){401===a.code?l.out():(n({message:"添加特殊建筑成功",duration:2e3,classes:"alert-success"}),t.isAddBuild=!1,t.build={playerid:"",zbid:"",avatar:"",name:"",role:"",tel:"",lng:"",lat:""},t.query_build())},function(a){t.isAddBuild=!0,n({message:"添加特殊建筑失败："+a.data,duration:1e4,classes:"alert-danger"})})}},t.del_build=function(a){t.del_build_id=a,t.modal=s.open({templateUrl:"remove_build_dialog",scope:t,size:"edit-setting-dialog"})},t.remove_build=function(){r("/walker/player/:id").remove({id:t.del_build_id},{}).$promise.then(function(a){401===a.code?l.out():(n({message:"删除特殊建筑成功",duration:2e3,classes:"alert-success"}),t.query_build(),t.close())},function(t){n({message:"删除特殊建筑失败："+t.data,duration:1e4,classes:"alert-danger"})})},t.buildEdit={},t.edit_build=function(a){t.editBuildData=a,t.buildEditId=a.playerid,t.buildEdit={avatar:a.avatar,name:a.name,tel:a.tel},t.modal=s.open({templateUrl:"edit_build_dialog",scope:t,size:"edit-build-dialog"})},t.edit_upload_build=function(a){a&&e.upload({url:"/v1/img/upload",method:"POST",data:{image:a}}).then(function(a){var a=a.data;"success"===a.status?(t.buildEdit.avatar=a.url,n({message:"图标上传成功",duration:1e4,classes:"alert-success"})):n({message:"图标上传失败",duration:1e4,classes:"alert-danger"})},function(t){n({message:"图标上传失败",duration:1e4,classes:"alert-danger"})},function(t){})},t.update_build=function(){r("/walker/player/:id").save({id:t.buildEditId},t.buildEdit).$promise.then(function(a){401===a.code?l.out():(n({message:"修改成功",duration:1e4,classes:"alert-success"}),t.editBuildData.avatar=t.buildEdit.avatar,t.editBuildData.name=t.buildEdit.name,t.editBuildData.tel=t.buildEdit.tel,t.modal.close())},function(t){n({message:"出错啦",duration:1e4,classes:"alert-danger"})})},t.player={avatar:"",name:"",tel:"",role:"",zburl:"",playerid:"",zbid:""},t.isAddPlayer=!1,t.query_player=function(){r("/walker/player/simplelist").query({}).$promise.then(function(a){401===a.code?l.out():t.players=a},function(t){n({message:"出错啦",duration:1e4,classes:"alert-danger"})})},t.query_player(),t.upload_player=function(a){a&&e.upload({url:"/v1/img/upload",method:"POST",data:{image:a}}).then(function(a){var a=a.data;"success"===a.status?(t.player.avatar=a.url,n({message:"头像上传成功",duration:1e4,classes:"alert-success"})):n({message:"头像上传失败",duration:1e4,classes:"alert-danger"})},function(t){n({message:"头像上传失败",duration:1e4,classes:"alert-danger"})},function(t){})},t.add_player_dialog=function(){t.modal=s.open({templateUrl:"add_player_dialog",scope:t,size:"edit-build-dialog"})},t.valid_player=function(){return t.player.avatar?t.player.zburl?t.player.playerid?t.player.zbid?t.player.name?t.player.tel?t.player.role?!0:(n({message:"请填写选手角色",duration:1e4,classes:"alert-danger"}),!1):(n({message:"请填写选手手机号码",duration:1e4,classes:"alert-danger"}),!1):(n({message:"请填写选手姓名",duration:1e4,classes:"alert-danger"}),!1):(n({message:"请填写房间id",duration:1e4,classes:"alert-danger"}),!1):(n({message:"请填写选手id",duration:1e4,classes:"alert-danger"}),!1):(n({message:"请填写直播url",duration:1e4,classes:"alert-danger"}),!1):(n({message:"请上传选手头像",duration:1e4,classes:"alert-danger"}),!1)},t.add_player=function(){if(t.valid_player()){t.isAddPlayer=!0;var a={};a.avatar=t.player.avatar,a.name=t.player.name,a.tel=t.player.tel,a.role=t.player.role,a.zburl=t.player.zburl,a.playerid=t.player.playerid,a.zbid=t.player.zbid,r("/walker/player/ ",{},{put:{method:"PUT",isArray:!1}}).put({},a).$promise.then(function(a){401===a.code?l.out():(n({message:"添加选手成功",duration:2e3,classes:"alert-success"}),t.modal.close(),t.isAddPlayer=!1,t.player={avatar:"",name:"",tel:"",role:"",zburl:"",playerid:"",zbid:""},t.query_player())},function(t){n({message:"添加选手失败："+t.data,duration:1e4,classes:"alert-danger"})})}},t.del_player=function(a){t.del_player_id=a,t.modal=s.open({templateUrl:"remove_player_dialog",scope:t,size:"edit-setting-dialog"})},t.remove_player=function(){r("/walker/player/:id").remove({id:t.del_player_id},{}).$promise.then(function(a){401===a.code?l.out():(n({message:"删除选手成功",duration:2e3,classes:"alert-success"}),t.query_player(),t.close())},function(t){n({message:"删除选手失败："+t.data,duration:1e4,classes:"alert-danger"})})},t.playerEdit={},t.edit_player=function(a){t.playerEditId=a.playerid,t.playerEditData=a,t.playerEdit={avatar:a.avatar,name:a.name,tel:a.tel,role:a.role,zburl:a.zburl,playerid:a.playerid,zbid:a.zbid},t.modal=s.open({templateUrl:"edit_player_dialog",scope:t,size:"edit-build-dialog"})},t.edit_upload_player=function(a){a&&e.upload({url:"/v1/img/upload",method:"POST",data:{image:a}}).then(function(a){var a=a.data;"success"===a.status?(t.playerEdit.avatar=a.url,n({message:"头像上传成功",duration:1e4,classes:"alert-success"})):n({message:"头像上传失败",duration:1e4,classes:"alert-danger"})},function(t){n({message:"头像上传失败",duration:1e4,classes:"alert-danger"})},function(t){})},t.update_player=function(){r("/walker/player/:id").save({id:t.playerEditId},t.playerEdit).$promise.then(function(a){401===a.code?l.out():(n({message:"修改成功",duration:1e4,classes:"alert-success"}),t.modal.close(),t.playerEditData.avatar=t.playerEdit.avatar,t.playerEditData.name=t.playerEdit.name,t.playerEditData.tel=t.playerEdit.tel,t.playerEditData.role=t.playerEdit.role,t.playerEditData.zburl=t.playerEdit.zburl,t.playerEditData.playerid=t.playerEdit.playerid,t.playerEditData.zbid=t.playerEdit.zbid)},function(t){n({message:"出错啦",duration:1e4,classes:"alert-danger"})})},t.close=function(){t.modal.close()}}]},function(t,a){t.exports='<div class="saw-setting">\r\n  <!--<div class="row">\r\n    <button class="btn btn-primary ml20" ng-click="allOpen()">全部开启</button>\r\n    <button class="btn btn-primary ml20" ng-click="allClose()">全部关闭</button>\r\n  </div>-->\r\n  <table class="table">\r\n    <thead>\r\n      <tr>\r\n        <th></th>\r\n        <th ng-repeat="data in playerList">{{data.name}}</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr ng-repeat="player in players">\r\n        <td>{{player.name}}</td>\r\n        <td ng-repeat=" data in datas[$index]">\r\n          <input type="checkbox" class="dpn chk" id="{{data.subjectId}}-{{data.objectId}}" ng-checked="data.checked" ng-model="data.checked"\r\n            ng-click="edit($event, data)">\r\n          <label for="{{data.subjectId}}-{{data.objectId}}" title="{{data.subname}}{{data.checked ? \'\' : \'不\'}}可看见{{data.name}}"></label>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>'},function(t,a){"use strict";t.exports=["$scope","$state","notify","$resource","$rootScope","$localStorage",function(t,a,e,n,r,s){s.isLogin||r.out(),t.allOpen=function(){n("/walker/setting/visible/all/on").get({}).$promise.then(function(a){401===a.code?r.out():(e({message:"全部开启设置成功",duration:1e4,classes:"alert-info"}),t.getUserSet())},function(t){r.out(),e({message:"全部开启设置失败",duration:1e4,classes:"alert-danger"})})},t.allClose=function(){n("/walker/setting/visible/all/off").get({}).$promise.then(function(a){401===a.code?r.out():(e({message:"全部关闭设置成功",duration:1e4,classes:"alert-info"}),t.getUserSet())},function(t){r.out(),e({message:"全部关闭设置失败",duration:1e4,classes:"alert-danger"})})},t.getUserSet=function(){n("/walker/setting/visible/ ").get({}).$promise.then(function(a){if(t.playerList=[],401===a.code)r.out();else{var e=a.players;for(var n in e)"-1"!==e[n].playerid&&t.playerList.push(e[n]);t.players=a.players,t.settings=a.visibleSettings,t.setData()}},function(t){e({message:"获取设置失败",duration:1e4,classes:"alert-danger"})})},t.setData=function(){var a=[];angular.forEach(t.players,function(e,n){angular.forEach(t.playerList,function(r,s){var l=!1,i=!1;angular.forEach(t.settings,function(t,a){l||t.subjectId===e.playerid&&t.objectId===r.playerid&&(i=!!t.visible,l=!0)}),a[n]||(a[n]=[]),a[n].push({subname:e.name,name:r.name,subjectId:e.playerid,objectId:r.playerid,checked:i})})}),t.datas=a},t.getUserSet(),t.edit=function(t,a){n("/walker/setting/visible/:subjectId/:objectId/:visible").get({objectId:a.objectId,subjectId:a.subjectId,visible:a.checked?1:0},{}).$promise.then(function(t){if(401===t.code)r.out();else{var n=a.subname+(a.checked?"可以看见":"不可以看见")+a.name;e({message:n,duration:1e4,classes:"alert-success"})}},function(t){e({message:"状态修改失败，请稍后重试",duration:1e4,classes:"alert-danger"}),a.checked=!a.checked})}}]},function(t,a){t.exports='<div class="tool-setting">\r\n  <div class="row">\r\n    <button class="btn btn-primary ml20" ng-click="allOpen()">全部开启</button>\r\n    <button class="btn btn-primary ml20" ng-click="allClose()">全部关闭</button>\r\n  </div>\r\n  <table class="table">\r\n    <thead>\r\n      <tr>\r\n        <th style="width: 80px;"></th>\r\n        <th style="width: 80px;" ng-repeat="data in items">{{data.title}}</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr ng-repeat="player in players">\r\n        <td>{{player.name}}</td>\r\n        <td ng-repeat=" data in datas[$index]">\r\n          <input type="checkbox" class="dpn chk" id="{{data.subjectId}}-{{data.objectId}}" ng-checked="data.checked" ng-model="data.checked"\r\n            ng-click="edit($event, data)">\r\n          <label for="{{data.subjectId}}-{{data.objectId}}" title="{{data.subname}}{{data.checked ? \'\' : \'不\'}}可看见{{data.name}}"></label>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>'},function(t,a){"use strict";t.exports=["$scope","$state","notify","$resource","$rootScope","$localStorage",function(t,a,e,n,r,s){s.isLogin||r.out(),t.allOpen=function(){n("/walker/setting/playeritem/all/allow").get({}).$promise.then(function(a){401===a.code?r.out():(e({message:"全部开启道具设置成功",duration:1e4,classes:"alert-info"}),t.getToolSet())},function(t){r.out(),e({message:"全部开启道具设置失败",duration:1e4,classes:"alert-danger"})})},t.allClose=function(){n("/walker/setting/playeritem/all/disallow").get({}).$promise.then(function(a){401===a.code?r.out():(e({message:"全部关闭道具设置成功",duration:1e4,classes:"alert-info"}),t.getToolSet())},function(t){r.out(),e({message:"全部关闭道具设置失败",duration:1e4,classes:"alert-danger"})})},t.getToolSet=function(){n("/walker/setting/playeritem/ ").get({}).$promise.then(function(a){401===a.code?r.out():(t.players=a.players,t.items=a.items,t.allow=a.allow,t.setData())},function(t){e({message:"获取道具设置失败",duration:1e4,classes:"alert-danger"})})},t.setData=function(){var a=[];angular.forEach(t.players,function(e,n){angular.forEach(t.items,function(r,s){var l=!1,i=!1;angular.forEach(t.allow,function(t,a){l||t.id===r.id&&t.playerid===e.playerid&&(i="1"===t.allow,l=!0)}),a[n]||(a[n]=[]),a[n].push({subname:e.name,name:r.title,subjectId:e.playerid,objectId:r.id,checked:i})})}),t.datas=a},t.getToolSet(),t.edit=function(t,a){n("/walker/setting/playeritem/:subjectId/:objectId/:visible").get({objectId:a.objectId,subjectId:a.subjectId,visible:a.checked?"1":"2"},{}).$promise.then(function(t){if(401===t.code)r.out();else{var n=a.subname+(a.checked?"可以看见":"不可以看见")+a.name;e({message:n,duration:1e4,classes:"alert-success"})}},function(t){e({message:"状态修改失败，请稍后重试",duration:1e4,classes:"alert-danger"}),a.checked=!a.checked})}}]},function(t,a){"use strict";var e=["$rootScope","$state","$interval","$localStorage","notify",function(t,a,e,n,r){t.out=function(){return n.isLogin=!1,a.go("login"),!1},t.$on("$stateChangeStart",function(t,a,e,n,r){}),t.$on("$stateChangeSuccess",function(a,n,r,s,l){"index.player"!==n.name&&t.timer&&e.cancel(t.timer)})}];t.exports=e},function(t,a){"use strict";t.exports=function(){return function(t){var a="";return a=t.length<=4?t:t.substring(0,3)+"..."}}},function(t,a){"use strict";t.exports=function(){return function(t){var a=[];return angular.forEach(t,function(t,e,n){t.mixAmount!==t.usedAmount&&a.push(t)}),a}}}]);